<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Painel de LED</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        h1 {
            color: #d00;
            margin-top: 40px;
        }
        .container {
            background: #fff;
            padding: 30px 40px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-top: 30px;
            min-width: 320px;
        }
        label {
            display: block;
            margin-top: 18px;
            font-weight: bold;
        }
        input[type="number"] {
            width: 100%;
            padding: 8px;
            margin-top: 6px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1em;
        }
        button {
            margin-top: 24px;
            padding: 10px 24px;
            background: #003366;
            color: #fff;
            border: none;
            border-radius: 4px;
            font-size: 1.1em;
            cursor: pointer;
        }
        #resultado {
            margin-top: 28px;
            font-size: 1.2em;
            color: #003366;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>CalcPixels</h1>
    <div class="container">
        <form id="form-calc" onsubmit="return false;">
            <label>Gabinete:</label>
            <select id="gabinete-select" onchange="toggleManualInputs()" required>
                <optgroup label="P3.9">
                    <option value="128x256">P3.9 0.5x1 (128x256)</option>
                    <option value="128x128">P3.9 0.5x0.5 (128x128)</option>
                </optgroup>
                <optgroup label="P2.x">
                    <option value="192x192">P2.5 0.5x0.5 (192x192)</option>
                    <option value="256x256">P2.0 0.5x0.5 (256x256)</option>
                </optgroup>
                <optgroup label="P2.9">
                    <option value="168x168">P2.9 0.5x0.5 (168x168)</option>
                    <option value="336x168">P2.9 1x0.5 (336x168)</option>
                </optgroup>
                <optgroup label="P5">
                    <option value="192x192">P5 0.96x0.96 (192x192)</option>
                    <option value="128x128">P5 0.64x0.64 (128x128)</option>
                </optgroup>
                <optgroup label="P6">
                    <option value="160x160">P6 0.96x0.96 (160x160)</option>
                    <option value="96x96">P6 0.576x0.576 (96x96)</option>
                </optgroup>
                <optgroup label="P10">
                    <option value="96x96">P10 0.96x0.96 (96x96)</option>
                </optgroup>
                <optgroup label="Manual">
                    <option value="manual">Manual</option>
                </optgroup>
            </select>
            <div id="manual-inputs" style="display:none;">
                <input type="number" id="pixels-largura" placeholder="Largura (px)" min="1">
                <input type="number" id="pixels-altura" placeholder="Altura (px)" min="1">
            </div>
            <div style="display: flex; align-items: center; gap: 8px; margin-top: 18px;">
                <label for="tipo-quantidade" style="margin: 0; font-weight: bold;">Quantidade de:</label>
                <select id="tipo-quantidade" onchange="toggleTipoQuantidade()" required style="margin: 0;">
                    <option value="gabinetes">Gabinetes:</option>
                    <option value="metros">Metros:</option>
                </select>
            </div>
            <div id="qtd-gabinetes">
                <label>Quantidade de gabinetes:</label>
                <input type="number" id="qtd-largura" placeholder="Largura (qtd)" min="1" required>
                <input type="number" id="qtd-altura" placeholder="Altura (qtd)" min="1" required>
            </div>
            <div id="qtd-metros" style="display:none;">
                <label>Dimensões em metros:</label>
                <input type="number" id="metros-largura" placeholder="Largura (m)" min="0.01" step="0.01">
                <input type="number" id="metros-altura" placeholder="Altura (m)" min="0.01" step="0.01">
            </div>
            <button type="submit" onclick="calcularPainel()">Calcular</button>
        </form>
        <div id="resultado"></div>
    </div>
    <script>
        // Tabela universal de gabinetes
        const modelosGabinetes = [
            { id: '128x256', label: 'P3.9 0.5x1 (128x256)', pixelsLargura: 128, pixelsAltura: 256, larguraRealM: 0.5, alturaRealM: 1, grupo: 'P3.9' },
            { id: '128x128', label: 'P3.9 0.5x0.5 (128x128)', pixelsLargura: 128, pixelsAltura: 128, larguraRealM: 0.5, alturaRealM: 0.5, grupo: 'P3.9' },
            { id: '192x192', label: 'P2.5 0.5x0.5 (192x192)', pixelsLargura: 192, pixelsAltura: 192, larguraRealM: 0.5, alturaRealM: 0.5, grupo: 'P2.x' },
            { id: '256x256', label: 'P2.0 0.5x0.5 (256x256)', pixelsLargura: 256, pixelsAltura: 256, larguraRealM: 0.5, alturaRealM: 0.5, grupo: 'P2.x' },
            { id: '168x168', label: 'P2.9 0.5x0.5 (168x168)', pixelsLargura: 168, pixelsAltura: 168, larguraRealM: 0.5, alturaRealM: 0.5, grupo: 'P2.9' },
            { id: '336x168', label: 'P2.9 1x0.5 (336x168)', pixelsLargura: 336, pixelsAltura: 168, larguraRealM: 1, alturaRealM: 0.5, grupo: 'P2.9' },
            { id: '192x192_P5', label: 'P5 0.96x0.96 (192x192)', pixelsLargura: 192, pixelsAltura: 192, larguraRealM: 0.96, alturaRealM: 0.96, grupo: 'P5' },
            { id: '128x128_P5', label: 'P5 0.64x0.64 (128x128)', pixelsLargura: 128, pixelsAltura: 128, larguraRealM: 0.64, alturaRealM: 0.64, grupo: 'P5' },
            { id: '160x160', label: 'P6 0.96x0.96 (160x160)', pixelsLargura: 160, pixelsAltura: 160, larguraRealM: 0.96, alturaRealM: 0.96, grupo: 'P6' },
            { id: '96x96_P6', label: 'P6 0.576x0.576 (96x96)', pixelsLargura: 96, pixelsAltura: 96, larguraRealM: 0.576, alturaRealM: 0.576, grupo: 'P6' },
            { id: '96x96', label: 'P10 0.96x0.96 (96x96)', pixelsLargura: 96, pixelsAltura: 96, larguraRealM: 0.96, alturaRealM: 0.96, grupo: 'P10' },
            { id: 'manual', label: 'Manual', grupo: 'Manual' }
        ];

        // Função para popular o dropdown de gabinetes
        function popularDropdownGabinetes() {
            const select = document.getElementById('gabinete-select');
            select.innerHTML = '';
            const grupos = [...new Set(modelosGabinetes.map(m => m.grupo))];
            grupos.forEach(grupo => {
                const optgroup = document.createElement('optgroup');
                optgroup.label = grupo;
                modelosGabinetes.filter(m => m.grupo === grupo).forEach(modelo => {
                    const option = document.createElement('option');
                    option.value = modelo.id;
                    option.textContent = modelo.label;
                    optgroup.appendChild(option);
                });
                select.appendChild(optgroup);
            });
        }
        // Chamar ao carregar
        window.onload = function() {
            popularDropdownGabinetes();
        };

        function toggleManualInputs() {
            const gabinete = document.getElementById('gabinete-select').value;
            const manualInputs = document.getElementById('manual-inputs');
            if (gabinete === 'manual') {
                manualInputs.style.display = 'block';
                document.getElementById('pixels-largura').required = true;
                document.getElementById('pixels-altura').required = true;
            } else {
                manualInputs.style.display = 'none';
                document.getElementById('pixels-largura').required = false;
                document.getElementById('pixels-altura').required = false;
            }
        }

        function toggleTipoQuantidade() {
            const tipo = document.getElementById('tipo-quantidade').value;
            if (tipo === 'gabinetes') {
                document.getElementById('qtd-gabinetes').style.display = 'block';
                document.getElementById('qtd-metros').style.display = 'none';
                document.getElementById('qtd-largura').required = true;
                document.getElementById('qtd-altura').required = true;
                document.getElementById('metros-largura').required = false;
                document.getElementById('metros-altura').required = false;
            } else {
                document.getElementById('qtd-gabinetes').style.display = 'none';
                document.getElementById('qtd-metros').style.display = 'block';
                document.getElementById('qtd-largura').required = false;
                document.getElementById('qtd-altura').required = false;
                document.getElementById('metros-largura').required = true;
                document.getElementById('metros-altura').required = true;
            }
        }

        function calcularPainel() {
            const gabineteId = document.getElementById('gabinete-select').value;
            const gabineteModelo = modelosGabinetes.find(m => m.id === gabineteId);
            let pxLarg, pxAlt, gabineteLargM, gabineteAltM;
            if (gabineteId === 'manual') {
                pxLarg = parseInt(document.getElementById('pixels-largura').value, 10);
                pxAlt = parseInt(document.getElementById('pixels-altura').value, 10);
                gabineteLargM = null;
                gabineteAltM = null;
            } else {
                pxLarg = gabineteModelo.pixelsLargura;
                pxAlt = gabineteModelo.pixelsAltura;
                gabineteLargM = gabineteModelo.larguraRealM;
                gabineteAltM = gabineteModelo.alturaRealM;
            }
            let qtdLarg, qtdAlt;
            const tipo = document.getElementById('tipo-quantidade').value;
            if (tipo === 'gabinetes') {
                qtdLarg = parseInt(document.getElementById('qtd-largura').value, 10);
                qtdAlt = parseInt(document.getElementById('qtd-altura').value, 10);
            } else {
                if (gabineteId === 'manual' || !gabineteLargM || !gabineteAltM) {
                    document.getElementById('resultado').textContent = 'Para cálculo por metros, selecione um gabinete pré-definido.';
                    return;
                }
                const metrosLarg = parseFloat(document.getElementById('metros-largura').value);
                const metrosAlt = parseFloat(document.getElementById('metros-altura').value);
                // Floor
                const qtdLarg_floor = Math.floor(metrosLarg / gabineteLargM);
                const qtdAlt_floor = Math.floor(metrosAlt / gabineteAltM);
                const largReal_floor = qtdLarg_floor * gabineteLargM;
                const altReal_floor = qtdAlt_floor * gabineteAltM;
                const diff_floor = Math.abs(metrosLarg - largReal_floor) + Math.abs(metrosAlt - altReal_floor);
                // Ceil
                const qtdLarg_ceil = Math.ceil(metrosLarg / gabineteLargM);
                const qtdAlt_ceil = Math.ceil(metrosAlt / gabineteAltM);
                const largReal_ceil = qtdLarg_ceil * gabineteLargM;
                const altReal_ceil = qtdAlt_ceil * gabineteAltM;
                const diff_ceil = Math.abs(metrosLarg - largReal_ceil) + Math.abs(metrosAlt - altReal_ceil);
                // Escolher o mais próximo
                if (diff_floor <= diff_ceil) {
                    qtdLarg = qtdLarg_floor;
                    qtdAlt = qtdAlt_floor;
                } else {
                    qtdLarg = qtdLarg_ceil;
                    qtdAlt = qtdAlt_ceil;
                }
            }
            if (isNaN(pxLarg) || isNaN(pxAlt) || isNaN(qtdLarg) || isNaN(qtdAlt)) {
                document.getElementById('resultado').textContent = 'Por favor, preencha todos os campos corretamente.';
                return;
            }
            const totalLarg = pxLarg * qtdLarg;
            const totalAlt = pxAlt * qtdAlt;
            const totalPixels = totalLarg * totalAlt;
            const pixelsPorPorta = 650000;
            const portasNecessarias = Math.ceil(totalPixels / pixelsPorPorta);
            function mdc(a, b) {
                return b === 0 ? a : mdc(b, a % b);
            }
            const divisor = mdc(totalLarg, totalAlt);
            const proporcaoLarg = totalLarg / divisor;
            const proporcaoAlt = totalAlt / divisor;
            let larguraRealM = '', alturaRealM = '';
            if (gabineteLargM && gabineteAltM) {
                larguraRealM = (qtdLarg * gabineteLargM).toFixed(2);
                alturaRealM = (qtdAlt * gabineteAltM).toFixed(2);
            }
            document.getElementById('resultado').innerHTML =
                `Resolução total do painel: <b>${totalLarg} x ${totalAlt} pixels</b><br>` +
                `Proporção: <b>${proporcaoLarg}:${proporcaoAlt}</b><br>` +
                (larguraRealM && alturaRealM ? `Dimensão real em metros: <b>${larguraRealM}m x ${alturaRealM}m</b><br>` : '') +
                `Quantidade de gabinetes: <b>${qtdLarg * qtdAlt} (${qtdLarg}x${qtdAlt})</b><br>` +
                `Pixels totais do projeto: <b>${totalPixels.toLocaleString('pt-BR')}</b><br>` +
                `Quantidade de portas necessárias da processadora: <b>${portasNecessarias}</b>`;
        }
    </script>
</body>
</html> 